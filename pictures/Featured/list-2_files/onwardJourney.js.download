/*
 *  Copyright 2011 Twitter, Inc.
 *  Licensed under the Apache License, Version 2.0 (the "License");
 *  you may not use this file except in compliance with the License.
 *  You may obtain a copy of the License at
 *
 *  http://www.apache.org/licenses/LICENSE-2.0
 *
 *  Unless required by applicable law or agreed to in writing, software
 *  distributed under the License is distributed on an "AS IS" BASIS,
 *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 *  See the License for the specific language governing permissions and
 *  limitations under the License.
 */

// http://paulirish.com/2011/requestanimationframe-for-smart-animating/
// http://my.opera.com/emoller/blog/2011/12/20/requestanimationframe-for-smart-er-animating
// requestAnimationFrame polyfill by Erik MÃ¶ller. fixes from Paul Irish and Tino Zijdel
// MIT license

define("utils/languageMappings",[],function(){"use strict";return{map:function(e){var t=e,n={"en-GB":"en","en-gb":"en","cy-GB":"cy","cy-gb":"cy","gd-GB":"gd","gd-gb":"gd","ga-GB":"ga","ga-gb":"ga","ru-uk":"ru",zh:"zh-hans","sr-latn":"sr"};return n[e]&&(t=n[e]),t}}}),define("utils/eventbus",[],function(){"use strict";var e={};return{addEventListener:function(t,n,i){e[t]||(e[t]=[]),e[t].push(n)},dispatch:function(t,n){if(void 0!==e[t])for(var i=0;i<e[t].length;i++)e[t][i](n)},DISMISS_CP:"DISMISS_CP",CAROUSEL_ITEM_CLICK:"CAROUSEL_ITEM_CLICK",COUNTDOWN_COMPLETE:"COUNTDOWN_COMPLETE",COUNTDOWN_CLICK:"COUNTDOWN_CLICK",SHOW_SMP_SCRUBBAR:"SHOW_SMP_SCRUBBAR",HIDE_SMP_SCRUBBAR:"HIDE_SMP_SCRUBBAR",COUNTDOWN_SKIPPED:"COUNTDOWN_SKIPPED",CAROUSEL_DRAGGED:"CAROUSEL_DRAGGED",NEXT_ITEM_PANEL_WIDTH:"NEXT_ITEM_PANEL_WIDTH",COUNTDOWN_STARTED:"COUNTDOWN_STARTED",CLOSE_BUTTON_CLICKED:"CLOSE_BUTTON_CLICKED",CAROUSEL_REQUIRES_UPDATED_ARIA:"CAROUSEL_REQUIRES_UPDATED_ARIA",ON_DEMAND_CAROUSEL_BUTTON_CLICK:"ON_DEMAND_CAROUSEL_BUTTON_CLICK",DISMISS_CLICK_FROM_NEXT_ITEM_PANEL:"DISMISS_CLICK_FROM_NEXT_ITEM_PANEL"}}),define("model/statsConstants",[],function(){"use strict";return{CP_STATS:"continuousPlay.stats",CP_PLAY:"continuousPlay.play",CP_STATS_OPEN_CAROUSEL:"openMoreVideos",CP_STATS_CLOSE_CAROUSEL:"closeMoreVideos",CP_STATS_DISMISS_CONT_PLAY:"dismissContPlay",CP_PLAY_VIDEO_COUNTDOWN_COMPLETE:"auto",CP_PLAY_VIDEO_COUNTDOWN_CLICKED:"cta",CP_PLAY_VIDEO_CAROUSEL_CLICKED:"carousel",CP_PLAY_VIDEO_REPLAY:"replay",CP_STATS_TURN_CP_ON:"turnCPon",CP_STATS_TURN_CP_OFF:"turnCPoff",AP_SONAR:"SonarUserActionEvent",AP_STATS_DISMISS_CONT_PLAY:"autoPlayPlugin_dismiss",AP_PLAY_VIDEO_COUNTDOWN_COMPLETE:"autoPlayPlugin_play_after_countdown_complete",AP_PLAY_VIDEO_COUNTDOWN_CLICKED:"autoPlayPlugin_play_after_nextItem_click",AP_PLAY_VIDEO_REPLAY:"autoPlayPlugin_replay",AP_STATS_TURN_AP_ON:"autoPlayPlugin_turn_ON",AP_STATS_TURN_AP_OFF:"autoPlayPlugin_turn_OFF",AP_STATS_COUNTDOWN_SKIPPED:"autoPlayPlugin_countdown_skipped",AP_PLAY_VIDEO_CAROUSEL_CLICKED:"carousel",AP_ON_DEMAND_CAROUSEL_BUTTON_CLICK:"autoPlayPlugin_on_demand_carousel_button_click",AP_DISMISS_CLICK_FROM_NEXT_ITEM_PANEL:"autoPlayPlugin_dismiss_from_next_item_panel"}}),define("model/copy",[],function(){"use strict";var e={autoPlugUpNext:"Up next in...",autoPlugUpNextStopped:"Up next",autoPlugCancel:"Cancel",autoPlugPlay:"Play next item",autoPlugCloseCountdownAccessibilityText:"Dismiss autoplay panel",autoPlugAccessibilityLabelCountdown:"The next item {title} will play automatically. Press CONTROL + Q to cancel",autoPlugAccessibilityLabelCountdownTouchDevice:"The next item {title} will play automatically, press dismiss autoplay panel to cancel",autoPlugAccessibilityCountdownStopped:"You have cancelled autoplay",autoPlugAccessibilityLabelCountdownNew:"To stop autoplay, select cancel button or use CONTROL + Q. Up next, {title}",autoPlugON:"ON",autoPlugOFF:"OFF",autoPlugMoreContents:"More",autoPlugLive:"LIVE",autoPlugRightChevron:"More clips",autoPlugLeftChevron:"Previous clips",autoPlugPlayItemNumber:"Play item {number} of {total}",autoPlugDurationTime:"Duration {time}",autoPlugWatchMore:"Watch more",autoPlugMoreClips:"More clips",autoPlugMoreProgrammes:"More programmes",autoPlugShowMore:"Show more",autoPlugMoreVideos:"More videos"};return{update:function(){for(var t in window.Language)e.hasOwnProperty(t)&&(e[t]=window.Language[t])},translations:e}}),define("model/templates",[],function(){"use strict";var e={};!function(e,t){function n(e){return String(null===e||void 0===e?"":e)}function i(e){return e=n(e),u.test(e)?e.replace(o,"&amp;").replace(a,"&lt;").replace(s,"&gt;").replace(l,"&#39;").replace(r,"&quot;"):e}e.Template=function(e,t,n,i){this.r=e||this.r,this.c=n,this.options=i,this.text=t||"",this.buf=""},e.Template.prototype={r:function(e,t,n){return""},v:i,t:n,render:function(e,t,n){return this.ri([e],t||{},n)},ri:function(e,t,n){return this.r(e,t,n)},rp:function(e,t,n,i){var o=n[e];return o?(this.c&&"string"==typeof o&&(o=this.c.compile(o,this.options)),o.ri(t,n,i)):""},rs:function(e,t,n){var i=e[e.length-1];if(!d(i))return void n(e,t,this);for(var o=0;o<i.length;o++)e.push(i[o]),n(e,t,this),e.pop()},s:function(e,t,n,i,o,a,s){var l;return(!d(e)||0!==e.length)&&("function"==typeof e&&(e=this.ls(e,t,n,i,o,a,s)),l=""===e||!!e,!i&&l&&t&&t.push("object"==typeof e?e:t[t.length-1]),l)},d:function(e,t,n,i){var o=e.split("."),a=this.f(o[0],t,n,i),s=null;if("."===e&&d(t[t.length-2]))return t[t.length-1];for(var l=1;l<o.length;l++)a&&"object"==typeof a&&o[l]in a?(s=a,a=a[o[l]]):a="";return!(i&&!a)&&(i||"function"!=typeof a||(t.push(s),a=this.lv(a,t,n),t.pop()),a)},f:function(e,t,n,i){for(var o=!1,a=null,s=!1,l=t.length-1;l>=0;l--)if((a=t[l])&&"object"==typeof a&&e in a){o=a[e],s=!0;break}return s?(i||"function"!=typeof o||(o=this.lv(o,t,n)),o):!i&&""},ho:function(e,t,n,i,o){var a=this.c,s=this.options;s.delimiters=o;var i=e.call(t,i);return i=null==i?String(i):i.toString(),this.b(a.compile(i,s).render(t,n)),!1},b:function(e){this.buf+=e},fl:function(){var e=this.buf;return this.buf="",e},ls:function(e,t,n,i,o,a,s){var l=t[t.length-1],r=null;if(!i&&this.c&&e.length>0)return this.ho(e,l,n,this.text.substring(o,a),s);if("function"==typeof(r=e.call(l))){if(i)return!0;if(this.c)return this.ho(r,l,n,this.text.substring(o,a),s)}return r},lv:function(e,t,i){var o=t[t.length-1],a=e.call(o);return"function"==typeof a&&(a=n(a.call(o)),this.c&&~a.indexOf("{{"))?this.c.compile(a,this.options).render(o,i):n(a)}};var o=/&/g,a=/</g,s=/>/g,l=/\'/g,r=/\"/g,u=/[&<>\"\']/,d=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}}("undefined"!=typeof exports?exports:e);var t={};return t.autoplayOnOffButton=new e.Template(function(e,t,n){var i=this;return i.b(n=n||""),i.b("<span class='somebg'></span>"),i.b("\n"+n),i.b("\n"+n),i.b('<div class="gcp_autoplayOnOffButtonDiv">'),i.b("\n"+n),i.b('\t<button href="#" class="gcp_autoplayOnOffButton" aria-label="'),i.b(i.v(i.f("accessibilityLabel",e,t,0))),i.b('">'),i.b("\n"+n),i.b("\t    "),i.b(i.v(i.f("title",e,t,0))),i.b("\n"+n),i.b("\t</button>"),i.b("\n"+n),i.b("</div>"),i.fl()}),t.carouselControls=new e.Template(function(e,t,n){var i=this;return i.b(n=n||""),i.b('<div class="gcp_carouselControlsButtons">'),i.b("\n"+n),i.b("\n"+n),i.b('    <button aria-label="'),i.b(i.v(i.f("closeButtonAccessibilityLabel",e,t,0))),i.b('" title="'),i.b(i.v(i.f("closeButtonAccessibilityLabel",e,t,0))),i.b('" class="gcp_panelsClose" aria-hidden="true" tabindex="-1">'),i.b("\n"+n),i.b('        <svg class="gcp_closeSVG" focusable="false">'),i.b("\n"+n),i.b('            <use xlink:href="#close" width="100%" height="100%" />'),i.b("\n"+n),i.b("        </svg>"),i.b("\n"+n),i.b("    </button>"),i.b("\n"+n),i.b("\n"+n),i.b("\n"+n),i.b('    <button class="gcp_carouselControlsPrevious" aria-label="'),i.b(i.v(i.f("previousButtonAccessibilityLabel",e,t,0))),i.b('" title="'),i.b(i.v(i.f("previousButtonAccessibilityLabel",e,t,0))),i.b('" aria-hidden="true" tabindex="-1">'),i.b("\n"+n),i.b('        <svg focusable="false">'),i.b("\n"+n),i.b('            <use xlink:href="#previous" width="100%" height="100%"/>'),i.b("\n"+n),i.b("        </svg>"),i.b("\n"+n),i.b("    </button>"),i.b("\n"+n),i.b('    <button class="gcp_carouselControlsNext gcp_inactive" aria-label="'),i.b(i.v(i.f("nextButtonAccessibilityLabel",e,t,0))),i.b('" title="'),i.b(i.v(i.f("nextButtonAccessibilityLabel",e,t,0))),i.b('" aria-hidden="true" tabindex="-1">'),i.b("\n"+n),i.b('        <svg focusable="false">'),i.b("\n"+n),i.b('            <use xlink:href="#next" width="100%" height="100%"/>'),i.b("\n"+n),i.b("        </svg>"),i.b("\n"+n),i.b("    </button>"),i.b("\n"+n),i.b("    "),i.b("\n"+n),i.b("</div>"),i.fl()}),t.carouselItem=new e.Template(function(e,t,n){var i=this;return i.b(n=n||""),i.b("<"),i.b(i.v(i.f("buttonOrDiv",e,t,0))),i.b(" "),i.b(i.v(i.f("role",e,t,0))),i.b(' class="gcp_item" href="#">'),i.b("\n"+n),i.b('    <div class="gcp_itemContainer">'),i.b("\n"+n),i.b('        <div class="gcp_itemWrap">'),i.b("\n"+n),i.b('            <div class="gcp_itemCta">'),i.b("\n"+n),i.b('                <svg class="gcp_itemCtaIcon" focusable="false" tabindex="-1">'),i.b("\n"+n),i.b('                     <use xlink:href="#play" width="100%" height="100%" />'),i.b("\n"+n),i.b("                </svg>"),i.b("\n"+n),i.b('                <h4 class="gcp_itemDuration backgroundFadedOut" aria-label="'),i.b(i.v(i.f("durationAriaLabel",e,t,0))),i.b('">'),i.b(i.v(i.f("duration",e,t,0))),i.b("</h4>"),i.b("\n"+n),i.b("            </div>"),i.b("\n"+n),i.b('            <img src="'),i.b(i.v(i.f("holdingImageURL",e,t,0))),i.b('" srcset="'),i.b(i.v(i.f("srcset",e,t,0))),i.b('" sizes="165px" class="gcp_itemImg" aria-hidden="true">'),i.b("\n"+n),i.b('            <div class="gcp_itemImgGradient"></div>'),i.b("\n"+n),i.b("        </div>"),i.b("\n"+n),i.b("\n"+n),i.b("        <div class=gcp_infoWrap>"),i.b("\n"+n),i.b('            <h3 class="gcp_itemTitle">'),i.b(i.v(i.f("title",e,t,0))),i.b("</h3>"),i.b("\n"+n),i.b('            <p class="gcp_itemDescription">'),i.b(i.v(i.f("description",e,t,0))),i.b("</p>"),i.b("\n"+n),i.b('            <div class="gcp_itemDateHolder">'),i.b("\n"+n),i.b('                <svg class="icon-clock" focusable="false">'),i.b("\n"+n),i.b('                    <use xlink:href="#duration-clock" width="100%" height="100%" />'),i.b("\n"+n),i.b("                </svg>"),i.b("\n"+n),i.b('                <h4 class="gcp_itemDate">'),i.b(i.v(i.f("date",e,t,0))),i.b("</h4>"),i.b("\n"+n),i.b("            </div>"),i.b("\n"+n),i.b("        </div>"),i.b("\n"+n),i.b("    </div>"),i.b("\n"+n),i.b("</"),i.b(i.v(i.f("buttonOrDiv",e,t,0))),i.b(">"),i.fl()}),t.countdownItem=new e.Template(function(e,t,n){var i=this;return i.b(n=n||""),i.b('<span class="gcp_countdownText" aria-hidden="true" >'),i.b(i.v(i.f("countdownText",e,t,0))),i.b("</span>"),i.b("\n"+n),i.b('<button aria-label="'),i.b(i.v(i.f("accessibilityLabel",e,t,0))),i.b('" title="'),i.b(i.v(i.f("accessibilityLabel",e,t,0))),i.b('" tabindex="1003" class="gcp_countdownClose">'),i.b("\n"+n),i.b('    <svg class="gcp_closeSVG">'),i.b("\n"+n),i.b('        <use xlink:href="#close" width="100%" height="100%" />'),i.b("\n"+n),i.b("    </svg>"),i.b("\n"+n),i.b("</button>"),i.fl()}),t.countdownSpinner=new e.Template(function(e,t,n){var i=this;return i.b(n=n||""),i.b('<div class="gcp_spinnerCountdownWrap">'),i.b("\n"+n),i.b("\n"+n),i.b('\t<div class="gcp_countdownNumber gcp_centerHelper">'),i.b("\n"+n),i.b("\t"),i.b("\n"+n),i.b('\t\t<button class="gcp_close_button gcp_centerHelper" tabindex="-1" >'),i.b("\n"+n),i.b('\t\t    <svg class="gcp_timerX" focusable="false" >'),i.b("\n"+n),i.b('\t        \t<use xlink:href="#close"/>'),i.b("\n"+n),i.b("\t    \t</svg>"),i.b("\n"+n),i.b("    \t</button>"),i.b("\n"+n),i.b("\n"+n),i.b('    \t<span class="gcp_timer">'),i.b(i.v(i.f("seconds",e,t,0))),i.b("</span>"),i.b("\n"+n),i.b("\n"+n),i.b("    </div>"),i.b("\n"+n),i.b("\n"+n),i.b('\t<button class="gcp_spinnerCountdown_button gcp_centerHelper" aria-atomic="true" aria-label="'),i.b(i.v(i.f("accessibilityLabelCountdown",e,t,0))),i.b('" tabindex="-1">'),i.b("\n"+n),i.b("\n"+n),i.b('\t\t<svg class="gcp_svgSpinner" viewBox="0 0 100 100" focusable="false">'),i.b("\n"+n),i.b("\n"+n),i.b("\t        <path"),i.b("\n"+n),i.b('\t        \td="'),i.b(i.v(i.f("default_pathString",e,t,0))),i.b('"'),i.b("\n"+n),i.b('\t\t        stroke-width="6"'),i.b("\n"+n),i.b('\t\t        fillOpacity="0"'),i.b("\n"+n),i.b('\t\t        stroke-dasharray="'),i.b(i.v(i.f("fullCircleStrokeDasharray",e,t,0))),i.b('"'),i.b("\n"+n),i.b('\t\t        stroke="#7f7f7f"'),i.b("\n"+n),i.b('\t\t        fill="none" '),i.b("\n"+n),i.b("\t\t        >"),i.b("\n"+n),i.b("\t        </path>"),i.b("\n"+n),i.b("\n"+n),i.b("\t        <path"),i.b("\n"+n),i.b('\t        \tclass="gcp_circle_animation"'),i.b("\n"+n),i.b('\t        \td="'),i.b(i.v(i.f("default_pathString",e,t,0))),i.b('"\t\t        '),i.b("\n"+n),i.b('\t        \tstroke-width="6"'),i.b("\n"+n),i.b('\t\t        fillOpacity="0"'),i.b("\n"+n),i.b('\t\t        style="'),i.b(i.v(i.f("pathStyle",e,t,0))),i.b('"'),i.b("\n"+n),i.b('\t\t        stroke="'),i.b(i.v(i.f("strokeColour",e,t,0))),i.b('"'),i.b("\n"+n),i.b('\t\t        fill="none" >'),i.b("\n"+n),i.b("\t        </path>"),i.b("\n"+n),i.b("\n"+n),i.b("      </svg>"),i.b("\n"+n),i.b("\n"+n),i.b("\t</button>"),i.b("\n"+n),i.b("\n"+n),i.b('\t<button class="gcp_cancel" aria-label="'),i.b(i.v(i.f("cancel",e,t,0))),i.b('" tabindex="-1">'),i.b(i.v(i.f("cancel",e,t,0))),i.b("</button>"),i.b("\n"+n),i.b("\n"+n),i.b("</div>"),i.fl()}),t.icons=new e.Template(function(e,t,n){var i=this;return i.b(n=n||""),i.b('<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" style="display: none;">'),i.b("\n"+n),i.b("\n"+n),i.b('    <symbol id="close" viewBox="0 0 44 44">'),i.b("\n"+n),i.b('        <rect x="20.281" y="8.162" transform="matrix(0.7073 0.7069 -0.7069 0.7073 21.9906 -9.1127)" fill="#FFFFFF" style="fill: inherit" width="3.437" height="27.676"/>'),i.b("\n"+n),i.b('        <rect x="20.281" y="8.162" transform="matrix(0.7071 -0.7071 0.7071 0.7071 -9.1127 22)" fill="#FFFFFF" style="fill: inherit" width="3.437" height="27.675"/>'),i.b("\n"+n),i.b("    </symbol>"),i.b("\n"+n),i.b('    <symbol id="continuous-play" viewBox="0 0 44 44">'),i.b("\n"+n),i.b('            <path fill="#FFFFFF" style="fill: inherit" d="M27.5,11H11v16.5h16.5V11z M25.438,25.438H13.062V13.062h12.375V25.438z"/>'),i.b("\n"+n),i.b('            <polygon fill="#FFFFFF" style="fill: inherit" points="30.25,14.438 28.875,14.438 28.875,28.875 14.438,28.875 14.438,30.25 30.25,30.25 "/>'),i.b("\n"+n),i.b('            <polygon fill="#FFFFFF" style="fill: inherit" points="31.625,16.5 31.625,31.625 16.5,31.625 16.5,33 33,33 33,16.5 "/>'),i.b("\n"+n),i.b('            <polygon fill="#FFFFFF" style="fill: inherit" points="16.5,15.125 16.5,23.375 23.114,19.25 "/>'),i.b("\n"+n),i.b("    </symbol>"),i.b("\n"+n),i.b('    <symbol id="duration-clock" viewBox="0 0 25 25">'),i.b("\n"+n),i.b('        <path fill="#FFFFFF" style="fill: inherit" d="M12.5,6C8.91,6,6,8.909,6,12.5c0,3.59,2.91,6.5,6.5,6.5s6.5-2.91,6.5-6.5C19,8.909,16.09,6,12.5,6z M12.5,17.5 c-2.758,0-5-2.243-5-5c0-2.758,2.242-5,5-5c2.757,0,5,2.242,5,5C17.5,15.257,15.257,17.5,12.5,17.5z"/>'),i.b("\n"+n),i.b('        <polygon fill="#FFFFFF" style="fill: inherit" points="13,9.067 12,9.067 12,12.696 15.227,14.574 15.555,14.005 13,12.117"/>'),i.b("\n"+n),i.b("    </symbol>"),i.b("\n"+n),i.b('    <symbol id="play" viewBox="0 0 44 44">'),i.b("\n"+n),i.b('        <polygon fill="#FFFFFF" style="fill: inherit"  points="14.4,33 32.3,22 14.4,11"/>'),i.b("\n"+n),i.b("    </symbol>"),i.b("\n"+n),i.b('    <symbol id="replay" viewBox="0 0 44 44">'),i.b("\n"+n),i.b('        <path fill="#FFFFFF" style="fill: inherit" d="M28.188,23.719c0,3.602-2.93,6.531-6.531,6.531s-6.531-2.93-6.531-6.531c0-3.601,2.93-6.531,6.531-6.531'),i.b("\n"+n),i.b("\tc0.115,0,0.229-0.006,0.344,0v-2.75c-0.115-0.004-0.229,0-0.344,0c-5.126,0-9.281,4.156-9.281,9.281"),i.b("\n"+n),i.b("\tc0,5.126,4.155,9.281,9.281,9.281s9.281-4.155,9.281-9.281c0-0.116,0.004-0.228,0-0.344h-2.75"),i.b("\n"+n),i.b('\tC28.193,23.49,28.188,23.603,28.188,23.719"/>'),i.b("\n"+n),i.b('        <polygon fill="#FFFFFF" style="fill: inherit" points="23.375,11 23.375,20.625 31.625,15.812 "/>'),i.b("\n"+n),i.b("    </symbol>"),i.b("\n"+n),i.b('    <symbol id="next" viewBox="0 0 44 44">'),i.b("\n"+n),i.b('        <polygon points="35,22 9,6 9,13.2 23.6,22 9,30.8 9,38 "/>'),i.b("\n"+n),i.b("    </symbol>"),i.b("\n"+n),i.b('    <symbol id="previous" viewBox="0 0 44 44">'),i.b("\n"+n),i.b('        <polygon points="9,22 35,6 35,13.2 20.4,22 35,30.8 35,38 "/>'),i.b("\n"+n),i.b("    </symbol>"),i.b("\n"+n),i.b('    <symbol id="tick">'),i.b("\n"+n),i.b('        <polygon points="8.52434955 14.1394665 15.2404 6.13496161 13.8884821 5 8.3073933 11.6518491 5.13348571 8.99155223 4 10.3434701"></polygon>'),i.b("\n"+n),i.b("    </symbol>"),i.b("\n"+n),i.b("\n"+n),i.b("</svg>"),i.fl()}),t.onDemandButton=new e.Template(function(e,t,n){var i=this;return i.b(n=n||""),i.b('<button id="gcp_onDemandButtonContainer" aria-label="'),i.b(i.v(i.f("accessibilityLabel",e,t,0))),i.b('" title="'),i.b(i.v(i.f("accessibilityLabel",e,t,0))),i.b('">'),i.b("\n"+n),i.b("\t<p>"),i.b(i.v(i.f("buttonText",e,t,0))),i.b("</p>"),i.b("\n"+n),i.b("</button>"),i.fl()}),t.settingsPanel=new e.Template(function(e,t,n){var i=this;return i.b(n=n||""),i.b('<div class="gcp_border"></div>'),i.b("\n"+n),i.b("\n"+n),i.b('<div class="gcp_settingsPanelHeader">'),i.b("\n"+n),i.b('    <div class="gcp_settingsPanelBlock gcp_settingsPanelTitle">'),i.b(i.v(i.f("title",e,t,0))),i.b("</div>"),i.b("\n"+n),i.b("    "),i.b("\n"+n),i.b('        <button class="gcp_onOffSwitchToggleButtonWrap" href="#" aria-label="'),i.b(i.v(i.f("accessibilityLabel",e,t,0))),i.b('" title="'),i.b(i.v(i.f("accessibilityLabel",e,t,0))),i.b('">'),i.b("\n"+n),i.b("\n"+n),i.b('            <label class="gcp_toggle">'),i.b("\n"+n),i.b('                <input type="checkbox" class="gcp_onOffSwitchToggle" checked>'),i.b("\n"+n),i.b('                <span role="checkbox" class="gcp_toggleSlider round" style="background-color: '),i.b(i.v(i.f("productColour",e,t,0))),i.b('">'),i.b("\n"+n),i.b('                    <svg class="gcp_tick" style="fill:'),i.b(i.v(i.f("productColour",e,t,0))),i.b('" focusable="false">'),i.b("\n"+n),i.b('                        <use xlink:href="#tick" width="100%" height="100%" />'),i.b("\n"+n),i.b("                    </svg>"),i.b("\n"+n),i.b("                </span>"),i.b("\n"+n),i.b("            </label>"),i.b("\n"+n),i.b("\n"+n),i.b("        </button>"),i.b("\n"+n),i.b("\n"+n),i.b("    </div>"),i.b("\n"+n),i.b("\n"+n),i.b("</div>"),i.fl()}),t}),define("utils/cssTools",[],function(){"use strict";var e=function(e){n(e,"fadedOut","fadedIn"),e.style.pointerEvents="none"},t=function(e){n(e,"fadedIn","fadedOut"),e.style.pointerEvents="auto"},n=function(e,t,n){if(e){var i=e.className;if(""===i)return void(e.className=t);i=i.replace(new RegExp("\\b"+n+"\\b","g"),"").replace(new RegExp("\\b"+t+"\\b","g"),"")+" "+t,e.className=i.trim()}};return{fadeIn:t,fadeOut:e,addRemoveCSSclassToElement:n,hasClass:function(e,t){return!!e&&(" "+e.className+" ").indexOf(" "+t+" ")>-1}}}),define("model/config",[],function(){"use strict";return{PRODUCT_NAME:"",CONT_PLAY_DATA_KEY:"smp.plugin.continuousplay.playlistSetChanged",IS_IPHONE_OR_IPOD:!1,IS_IOS:!1,IS_MAC_SAFARI:!1,IS_IPHONE:!1,IOS_VERSION:null,IS_OLD_IPAD:!1,IS_WINDOWS:!1,NEEDS_USER_TRIGGERED_FIRST_PLAY:!1,DEFAULT_COUNTDOWN_SECS:10,AD_PLUGIN_EXISTS:!1,PRETEND_PLAYLIST_HAS_ADS:!1,AUTOPLAY_FIRST_ITEM:!0,CP_ENABLED:!0,HAS_FOCUS_BUG:!1,SHOW_LIVE_OR_DURATION:!1,CAROUSEL_UPDATED:!1,STOP_ON_GUIDANCE:!1,FULLSCREEN_ONLY_CAROUSEL:!1,OPEN_CAROUSEL_BUTTON_LABEL:1,DISABLE_WHEN_EMBEDDED:!1,DISABLE_WHEN_EMBEDDED_BREAKPOINT:1e4}}),define("utils/playlistTools",["model/config","utils/cssTools"],function(e,t){"use strict";var n=function(){return"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKMAAABbCAYAAAAfrTX0AAAAwElEQVR42u3SQQ0AAAjEsOOBf8lgg5BWwrLqZAIHlBkxI5gRM4IZMSOYETOCGTEjmBEzghkxI5gRM4IZwYyYEcyIGcGMmBHMiBnBjJgRzIgZwYyYEcyIGc2IGcGMmBHMiBnBjJgRzIgZwYyYEcyIGcGMmBHMCGbEjGBGzAhmxIxgRswIZsSMYEbMCGbEjGBGzCgDZgQzYkYwI2YEM2JGMCNmBDNiRjAjZgQzYkYwI5gRM4IZMSOYETOCGTEjmJFHFheWXMhUnWyXAAAAAElFTkSuQmCC"},i=function(e,t){for(var n=!1,i=0;i<e.items.length;i++){if(t==e.items[i].vpid){n=!0;break}if(t==e.items[i].versionID){n=!0;break}}return n};return{validateTheData:function(e,n){for(var i=[],o=0;o<25&&o<e.items.length;o++){var a=e.items[o].playlist,s=a&&e.items[o].playlist.items.length>0;a&&s&&i.push(e.items[o])}return 0==i.length?t.addRemoveCSSclassToElement(n,"hideOnwardJourney",""):t.addRemoveCSSclassToElement(n,"","hideOnwardJourney"),i},checkForLoadedPlaylistURLorPIDinData:function(e,t){var n=-1;if(t.length>0)for(var o=0;o<t.length;o++){var a=t[o].playlist;if("string"==typeof a){if(e==a){n=o;break}}else if(i(a,e)){n=o;break}}return n},getFirstProgrammeItem:function(e){for(var t=0;t<e.items.length;t++){var n=e.items[t].kind;if(!n)return e.items[t];if("programme"==n||"radioProgramme"==n||"audio"==n||"360"==n)return e.items[t]}return""},mergeIntoPlaylist:function(e){function t(t,n){n?e[t]&&(e.playlist[n]=e[t],delete e[t]):e[t]&&(e.playlist[t]=e[t],delete e[t])}var n;for(n in e)if(e.hasOwnProperty(n)&&"playlist"!=n)switch(n){case"title":t("title");break;case"description":t("description","summary");break;case"imgUrl":t("imgUrl","holdingImageURL");break;case"date":t("date")}return!1!==e.playlist.allowContinuousCast&&(e.playlist.allowContinuousCast=!0),e.playlist},setLiveOrDuration:function(t,n,i){var o;if(t.showLiveOrDuration?e.SHOW_LIVE_OR_DURATION=t.showLiveOrDuration:(e.SHOW_LIVE_OR_DURATION=!1,o=""),e.SHOW_LIVE_OR_DURATION)for(var a=0;a<n.items.length;a++)"ident"!=n.items[a].kind&&"advert"!=n.items[a].kind&&(o=window.Utils.secondsToTime(n.items[a].duration)),n.items[a].live&&(o=i.autoPlugLive);return o},getVoiceReadersDuration:function(e,t){var n="";return""!==e&&(e!==t.autoPlugLive?(n=t.autoPlugDurationTime,n=n.replace("{time}",e)):n=t.autoPlugLive),n},getFallbackImage:n}}),define("model/cpModel",["utils/playlistTools"],function(e){"use strict";var t=[],n="",i=-1,o=-1,a=null,s=function(e){t=e},l=function(){return t},r=function(e){return t[e]},u=function(e){i=e},d=function(){return t[i]},c=function(){return i},b=function(){return t[i+1]},f=function(){return i+1<t.length},g=function(e){a=e,n=p(e)},p=function(t){var n;if(t.url)n=t.url;else{var i=e.getFirstProgrammeItem(t);n=i.identifier?i.identifier:i.mediatorIdentifier}return n},m=function(){return n},_=function(){-1!=i&&(o=i),a=null,n="",i=-1,h.showingAds=!1,h.playlistLoading=!0},v=function(){return o},h={isFullscreen:!1,countdownRunning:!1,videoWidth:0,highlightColour:"#ff00ff",foreHighlightColour:"ffffff",showingAds:!1,settingsOpen:!1,tooSmallForContinuousPlay:!1,ctaIsShowing:!1,playlistLoading:!1,buttonsArray:[],windowWidth:0,nextItemPanelWidth:0,onDemandCarouselShown:!1,controlsAlwaysOriginalSetting:!1,previousActiveElement:null,enhanceBrightColoursContrast:!1};return{setItems:s,getItems:l,getItemAtIndex:r,getCurrentlyPlayingItem:d,getCurrentlyPlayingItemIndex:c,getNextPlayingItem:b,setLoadedPlaylist:g,getLoadedPlaylistURLorPID:m,resetForNewPlaylist:_,setCurrentlyPlayingIndex:u,hasMoreItemsToPlay:f,getJustPlayedIndex:v,getURLorPID:p,viewModel:h}}),define("utils/generalUtils",[],function(){"use strict";return{addHandlerToMultipleEvents:function(e,t,n,i){var o;i=!!i;for(var a=0;a<t.length;a++)o=t[a],e.addEventListener(o,n,i)}}}),define("utils/uiListener",[],function(){"use strict";return{add:function(e,t,n,i,o){var a=!1;!1!==o&&(o=!0),e.addEventListener("touchstart",function(e){a=!0,setTimeout(function(){a=!1},500)}),t&&e.addEventListener("click",function(n){return t.bind(e)(n,a)}),n&&(e.addEventListener("mouseenter",function(t){if(!a)return n.bind(e)(t,a)}),e.addEventListener("focus",function(t){if(!a)return n.bind(e)(t,a)}),o&&e.addEventListener("touchstart",function(t){return n.bind(e)(t,a)})),i&&(e.addEventListener("mouseleave",function(t){if(!a)return i.bind(e)(t,a)}),e.addEventListener("blur",function(t){return i.bind(e)(t,a)}),o&&document.addEventListener("touchend",function(t){return i.bind(e)(t,a)}))}}}),define("utils/requestAnimationFramePolyfill",[],function(){"use strict";!function(){for(var e=0,t=["ms","moz","webkit","o"],n=0;n<t.length&&!window.requestAnimationFrame;++n)window.requestAnimationFrame=window[t[n]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[t[n]+"CancelAnimationFrame"]||window[t[n]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(t,n){var i=(new Date).getTime(),o=Math.max(0,16-(i-e)),a=window.setTimeout(function(){t(i+o)},o);return e=i+o,a}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(e){clearTimeout(e)})}()}),define("carousel/DraggableDiv",["model/templates","utils/cssTools","model/cpModel","utils/generalUtils","utils/uiListener","model/config","utils/eventbus","utils/requestAnimationFramePolyfill"],function(e,t,n,i,o,a,s,l){return function(){var i,l,r,u,d,c,b,f,g,p,m,_,v,h,C,E,A,y,I,P,S,w,T,L,O,D,N,M=0,R=!1,x=!1,U=0,F=!1,B=function(e){(R||f-g>20)&&e.preventDefault&&(e.preventDefault(),e.stopPropagation())},k=function(){return(new Date).getTime()},W=function(e){if(cancelAnimationFrame(m),y=[],!R&&e){c=parseFloat(i.style.left)||0,b=parseFloat(i.style.top)||0;var t=e.changedTouches;t&&(e=t[0]),h=e.pageX,C=e.pageY,E=h,i.addEventListener("touchend",G),i.addEventListener("touchmove",Y),i.addEventListener("touchcancel",G),document.addEventListener("mousemove",Y),document.addEventListener("mouseup",G),g=k(),R=!0}},Y=function(e){if(R){e.preventDefault();var t,n,i,o,a,s,d=e.changedTouches;d&&(e=d[0]),t=e.pageX,n=e.pageY,i=t-h,o=n-C,o<2&&o>-2&&(o=0),i<2&&i>-2&&(i=0),r||(i=0),l||(o=0),a=c+i,s=b+o,u&&(a<-(u[u.length-1]+186)+186*Math.floor((window.innerWidth-60)/186)&&(a=-(u[u.length-1]+186)+186*Math.floor((window.innerWidth-60)/186)),a>u[0]&&(a=u[0])),M===a&&p===s||(M=a,p=s,x||(x=!0)),y.push(t<E?1:0),E=t,A=n,I=requestAnimationFrame(K)}},H=function(){if(N&&(N=h-E)<4&&N>-4)return void(x=!1);if(M<1e-6&&M>-1e-6&&(M=0),p<1e-6&&p>-1e-6&&(p=0),l&&(i.style.top=p+"px"),r){s.dispatch(s.CAROUSEL_DRAGGED);var e=J()?8:0;t.hasClass(T,"gcp_nextItemPanelClosed")&&(i.style.left=M+e*U+"px")}X()},G=function(e){cancelAnimationFrame(I);var t;if(i.removeEventListener("touchend",G),i.removeEventListener("touchmove",Y),i.removeEventListener("touchcancel",G),document.removeEventListener("mousemove",Y),document.removeEventListener("mouseup",G),e&&(t=e.changedTouches,t&&(e=t[0]),e.pageX,e.pageY),x&&(f=k(),x=!1,u)){var n,o=-1,a=[];for(n=0;n<u.length;n++)a.push(u[n]+M);if(!0===q(y)){for(n=a.length-1;n>-1;n--)if(a[n]<=-8){o=n;break}-1==o&&(o=0)}else for(n=0;n<a.length;n++)if(a[n]>=-16){o=n;break}U=o,_=-u[o],v=0,m=requestAnimationFrame(V)}R=!1,setTimeout(function(){s.dispatch(s.CAROUSEL_REQUIRES_UPDATED_ARIA)},600)},K=function(){N=!0,H()},V=function(){var e=M,t=.1*(_-e),n=e+t,i=!0;Math.abs(t)<1&&(i=!1,n=_),M=n,H(),i?m=requestAnimationFrame(V):cancelAnimationFrame(m)},X=function(){var e=t.hasClass(T,"helper_carouselFadedIn");if(j()?(t.addRemoveCSSclassToElement(w,"","gcp_inactive"),e&&(w.tabIndex="1004",O.tabIndex="1003")):(t.addRemoveCSSclassToElement(w,"gcp_inactive"),w.tabIndex=-1,w.style.fill="",w.style.backgroundColor=""),J()){t.addRemoveCSSclassToElement(S,"","gcp_inactive"),e&&(S.tabIndex="1005"),t.addRemoveCSSclassToElement(L,"gcp_LeftGradientfadedOut","gcp_LeftGradientfadedIn");t.hasClass(T,"gcp_nextItemPanelClosed")?t.addRemoveCSSclassToElement(T,"","helper_leftGradientFadedIn"):t.addRemoveCSSclassToElement(T,"helper_leftGradientFadedIn","")}else t.addRemoveCSSclassToElement(S,"gcp_inactive"),S.tabIndex=-1,S.style.fill="",S.style.backgroundColor="",t.addRemoveCSSclassToElement(L,"gcp_LeftGradientfadedIn","gcp_LeftGradientfadedOut"),t.addRemoveCSSclassToElement(T,"helper_leftGradientFadedIn","")},j=function(){var e=n.viewModel.nextItemPanelWidth,i=t.hasClass(T,"gcp_nextItemPanelClosed"),o=i?186:0,a=i?M:0;return u[u.length-1]+o+a>window.innerWidth-e},J=function(){return isNaN(M)&&(M=-186),M<0},q=function(e){for(var t=e.length<5?0:e.length-5,n=0,i=e.length-1;i>t;i--)0===e[i]&&n++;return n>3},z=function(){N=!1,a.HAS_FOCUS_BUG||S.focus(),t.hasClass(S,"gcp_inactive")||(U-=Math.floor((window.innerWidth-60)/186),ee(U)),X(),setTimeout(function(){s.dispatch(s.CAROUSEL_REQUIRES_UPDATED_ARIA)},600)},Q=function(){if(N=!1,a.HAS_FOCUS_BUG||w.focus(),!t.hasClass(w,"gcp_inactive")){U+=Math.floor((window.innerWidth-60)/186);var e=!t.hasClass(T,"gcp_nextItemPanelClosed");ee(e?0:U)}X(),setTimeout(function(){s.dispatch(s.CAROUSEL_REQUIRES_UPDATED_ARIA)},600)},Z=function(e){e.shiftKey&&9==e.keyCode&&!a.HAS_FOCUS_BUG&&(F=!0)},$=function(){if(F){var e=i.getElementsByTagName("button")[0];e&&(e.focus(),F=!1)}},ee=function(e){e=Math.max(Math.min(u.length-1,e),0),U=e,_=-u[e],_<-(u[u.length-1]+186)+186*Math.floor((window.innerWidth-60)/186)&&(_=-(u[u.length-1]+186)+186*Math.floor((window.innerWidth-60)/186),U=u.length-1-(Math.floor((window.innerWidth-60)/186)-1)),_>u[0]&&(_=u[0],U=0),V()},te=function(e){t.hasClass(this,"gcp_inactive")||(this.style.fill=n.viewModel.foreHighlightColour,this.style.backgroundColor=n.viewModel.highlightColour)},ne=function(e){t.hasClass(this,"gcp_inactive")||(this.style.fill="",this.style.backgroundColor="")},ie=function(){this.style.fill=n.viewModel.highlightColour},oe=function(){this.style.fill=""},ae=function(){s.dispatch(s.CLOSE_BUTTON_CLICKED)};this.init=function(t,n,a,s,c,b){i=t,P=n,T=s,L=b,L.firstChild.textContent=c.autoPlugUpNextStopped,P.innerHTML=e.carouselControls.render({closeButtonAccessibilityLabel:c.autoPlugCloseCountdownAccessibilityText,nextButtonAccessibilityLabel:c.autoPlugRightChevron,previousButtonAccessibilityLabel:c.autoPlugLeftChevron}),D=document.getElementsByClassName("gcp_item"),S=P.getElementsByClassName("gcp_carouselControlsPrevious")[0],o.add(S,z,te,ne),S.addEventListener("keydown",Z),S.addEventListener("blur",$),w=P.getElementsByClassName("gcp_carouselControlsNext")[0],O=T.getElementsByClassName("gcp_panelsClose")[0],o.add(w,Q,te,ne),o.add(O,ae,ie,oe),l=void 0===a.moveOnYaxis||a.moveOnYaxis,r=void 0===a.moveOnXaxis||a.moveOnXaxis,u=a.xTargets,d=a.yTargets,u&&u.length&&X(),i.style.position="absolute",i.addEventListener("mousedown",W),i.addEventListener("touchstart",W),i.addEventListener("click",B,!0),i.ondragstart=i.onselectstart=function(){return!1}},this.setPosition=function(e){P&&(P.style.top="useBottom"!==e?e+"px":"")},this.update=function(e){l=void 0===e.moveOnYaxis||e.moveOnYaxis,r=void 0===e.moveOnXaxis||e.moveOnXaxis,u=e.xTargets,d=e.yTargets,u&&u.length&&X()},this.positionAtIndex=function(e){ee(e)},this.animateToIndex=function(e){ee(e)},this.updateScrollButtons=function(){X()},this.canScrollForward=function(e){return j()},this.resetX=function(){M=0}}}),define("carousel/carousel",["carousel/DraggableDiv","model/cpModel","model/copy","model/templates","utils/eventbus","utils/cssTools","utils/playlistTools","model/config"],function(e,t,n,i,o,a,s,l){"use strict";var r,u,d,c,b,f,g,p,m,_,v,h,C,E,A,y,I=[],P=!1,S=!1,w=!1,T=!1,L=function(t,i){r=t.container,u=i,d=t.background,f=t.controls,h=n.translations,c=d.getElementsByClassName("gcp_carouselBackgroundLeftGradient")[0],d.firstChild.textContent=h.autoPlugMoreContents,c&&(c.setAttribute("aria-hidden","true"),d.firstChild.setAttribute("aria-hidden","true")),b=new e,b.init(r,f,{moveOnYaxis:!1},u,h,c),g=f.getElementsByClassName("gcp_carouselControlsPrevious")[0],p=f.getElementsByClassName("gcp_carouselControlsNext")[0],m=f.getElementsByClassName("gcp_panelsClose")[0],D(),M(),w=!0,F()},O=function(e){r&&("useBottom"!==e?(r.style.top=e+"px",d.style.top=e+"px",b.setPosition(e)):(r.style.top="",d.style.top="",r.style.bottom=0,d.style.bottom=0,b.setPosition("useBottom")))},D=function(){r.addEventListener("mousedown",function(e){A=-1}),r.addEventListener("touchstart",function(e){y={x:e.touches[0].pageX,y:e.touches[0].pageY},A=-1}),r.addEventListener("touchend",function(e){var t=Math.abs(e.changedTouches[0].pageX-y.x),n=Math.abs(e.changedTouches[0].pageY-y.y);t<10&&n<10&&(T=!0,setTimeout(function(){T&&N()},100))}),r.addEventListener("click",function(e){T=!1,N()}),r.addEventListener("keyup",function(e){if(t.viewModel.previousActiveElement&&"gcp_onDemandButtonContainer"===t.viewModel.previousActiveElement.id)return void(t.viewModel.previousActiveElement=null);if(w){var n=e.keyCode?e.keyCode:e.which;13!==n&&32!==n||N()}})},N=function(){if(-1!=A){var e=t.getItemAtIndex(A),n=e.playlist,i="string"==typeof n?n:s.getFirstProgrammeItem(n).vpid||s.getFirstProgrammeItem(n).versionID;t.loadedPlaylistURLorPID!=i&&o.dispatch(o.CAROUSEL_ITEM_CLICK,e)}},M=function(e){I=[],t.viewModel.buttonsArray=[],R();for(var n=t.getItems(),o=0;o<n.length;o++)!function(e,l){
t.viewModel.windowWith=window.innerWidth;var d=s.mergeIntoPlaylist(e),c=s.getFallbackImage(),f="";d.holdingImageURL&&window.Utils&&(c=window.Utils.doChef(d.holdingImageURL,null,null,200),f=window.Utils.getImgSources(d.holdingImageURL));var g=document.createElement("li");g.className=e.live?"gcp_carouselItem gcp_live":"gcp_carouselItem";var p=s.setLiveOrDuration(e,d,h),m=s.getVoiceReadersDuration(p,h);g.innerHTML=i.carouselItem.render({buttonOrDiv:"div",role:'role = "button"',title:d.title,holdingImageURL:c,srcset:f,description:d.summary,date:d.date,duration:p,durationAriaLabel:m});var y=g.childNodes[0],w=y.getElementsByClassName("gcp_itemCtaIcon")[0],T=d.title+" "+m;T=h.autoPlugPlayItemNumber+" "+T,T=T.replace("{number}",o+1),T=T.replace("{total}",n.length),y.setAttribute("aria-label",T),y.setAttribute("title",d.title);var L=t.viewModel.windowWith>400?456:248;v=186*(n.length-1)+L<t.viewModel.windowWith,y.setAttribute("tabIndex","1005"),y.addEventListener("mouseup",function(e){A&&A!==l&&(A=-1),P=!1}),y.addEventListener("touchend",function(e){A=l,P=!1}),y.addEventListener("mousedown",function(e){A=l,P=!0}),y.addEventListener("keydown",function(e){var t=e.keyCode?e.keyCode:e.which;13!==t&&32!==t||(A=l,P=!0)}),y.addEventListener("touchstart",function(e){P=!0,S=!0,setTimeout(function(){S=!1},1e3)}),y.addEventListener("mouseover",function(e){S||(w.style.backgroundColor=t.viewModel.highlightColour,w.style.fill=t.viewModel.foreHighlightColour,y.style.backgroundColor="#404040")}),y.addEventListener("focus",function(e){S||(w.style.backgroundColor=t.viewModel.highlightColour,w.style.fill=t.viewModel.foreHighlightColour,y.style.backgroundColor="#404040")}),y.addEventListener("mouseout",function(e){S||(w.style.backgroundColor="#000000",w.style.fill="#ffffff",y.style.backgroundColor="")}),y.addEventListener("blur",function(e){S||(w.style.backgroundColor="#000000",w.style.fill="#ffffff",y.style.backgroundColor="")}),y.addEventListener("focus",function(e){var n=a.hasClass(u,"gcp_nextItemPanelClosed");if(!1===P&&n){if(I[l].getElementsByClassName("gcp_item")[0].getBoundingClientRect().left+t.viewModel.nextItemPanelWidth<=0){var i=l-Math.floor((t.viewModel.windowWith-60)/186)+1;b.animateToIndex(i)}E[l]+t.viewModel.nextItemPanelWidth>=t.viewModel.windowWith-60&&(b.animateToIndex(l),U()),W()}}),y.addEventListener("click",function(e){A=l}),g.style.marginRight="16px";var O=186*o;C.push(O),E=C,e.button=y,I.push(g),t.viewModel.buttonsArray.push(g),0!=o?r.appendChild(g):_=g}(n[o],o);var l=186*t.getItems().length+2e3;r.style.width=l+"px",b.update({moveOnYaxis:!1,xTargets:C}),e&&Y(),1==n.length?a.addRemoveCSSclassToElement(u,"singleCarouselItem",""):a.addRemoveCSSclassToElement(u,"","singleCarouselItem")},R=function(){for(C=[];r.hasChildNodes();)r.removeChild(r.lastChild)},x=function(e,n){var i=a.hasClass(u,"gcp_nextItemPanelClosed");if(e&&B(0),Y(),!w){a.fadeIn(r),a.fadeIn(d),a.fadeIn(f),g&&(g.setAttribute("tabIndex","1005"),g.setAttribute("aria-hidden","false")),p&&(p.setAttribute("tabIndex","1004"),p.setAttribute("aria-hidden","false")),m&&(m.setAttribute("tabIndex","1003"),m.setAttribute("aria-hidden","false"));for(var o=t.getItems(),s=0;s<o.length;s++){o[s].button.getBoundingClientRect().right<t.viewModel.windowWith&&i&&(o[s].button.setAttribute("tabIndex","1006"),o[s].button.setAttribute("aria-hidden","false"))}}if(v&&U(),w=!0,a.addRemoveCSSclassToElement(u,"helper_carouselFadedIn","helper_carouselFadedOut"),n){o[t.hasMoreItemsToPlay()?t.getCurrentlyPlayingItemIndex()+1:0].button.focus()}},U=function(e){v=186*(I.length-1)+t.viewModel.nextItemPanelWidth<t.viewModel.windowWith;var n=a.hasClass(u,"gcp_nextItemPanelClosed");if(w&&n||v)for(var i=t.getItems(),o=0;o<i.length;o++){var s=i[o].button.getBoundingClientRect();s.right<t.viewModel.windowWith&&s.left>0?(i[o].button.setAttribute("tabIndex","1006"),i[o].button.setAttribute("aria-hidden","false")):(i[o].button.setAttribute("tabIndex","-1"),i[o].button.setAttribute("aria-hidden","true"))}},F=function(){if(w){a.fadeOut(r),a.fadeOut(d),a.fadeOut(f),g&&(g.setAttribute("tabIndex","-1"),g.setAttribute("aria-hidden","true")),p&&(p.setAttribute("tabIndex","-1"),p.setAttribute("aria-hidden","true")),m&&(m.setAttribute("tabIndex","-1"),m.setAttribute("aria-hidden","true"));var e=t.getItems();if(e)for(var n=0;n<e.length;n++)e[n].button.setAttribute("tabIndex","-1"),e[n].button.setAttribute("aria-hidden","true")}w=!1,t.viewModel.previousActiveElement=null,a.addRemoveCSSclassToElement(u,"helper_carouselFadedOut","helper_carouselFadedIn")},B=function(e){b&&b.positionAtIndex(e)},k=function(){return A},W=function(){b&&b.updateScrollButtons()},Y=function(){l.CAROUSEL_UPDATED=!0,R();for(var e=t.getCurrentlyPlayingItemIndex()+1,n=0;n<I.length;n++)n!=e&&r.appendChild(I[n]);a.hasClass(u,"gcp_nextItemPanelClosed")&&I[e]&&r.insertBefore(I[e],r.childNodes[0]),setTimeout(function(){U()},500)};return{init:L,positionAtIndex:B,getClickedOnCarouselItemIndex:k,show:x,hide:F,createCarousel:M,updateScrollButtons:W,updateCarouselItemsList:Y,reSetCarouselLeft:function(){r.style.left="",b.resetX()},updateAriaAndTabIndex:U,setPosition:O}}),define("carousel/onDemandCarouselButton",["utils/eventbus","utils/uiListener","model/cpModel","model/config","model/templates","model/copy"],function(e,t,n,i,o,a){"use strict";var s,l,r,u=function(t){var n=0===t.offsetX&&0===t.offsetY;e.dispatch(e.ON_DEMAND_CAROUSEL_BUTTON_CLICK,n)},d=function(){var e=n.viewModel.enhanceBrightColoursContrast?"#000000":"#fff";l.style.backgroundColor=n.viewModel.highlightColour,l.style.color=e},c=function(){l.style.backgroundColor="",l.style.color="#fff"};return{init:function(e){r=a.translations,s=e;var n;switch(i.OPEN_CAROUSEL_BUTTON_LABEL){case 1:n=r.autoPlugWatchMore;break;case 2:n=r.autoPlugMoreClips;break;case 3:n=r.autoPlugMoreProgrammes;break;case 4:n=r.autoPlugShowMore;break;case 5:n=r.autoPlugMoreContents;break;case 6:n=r.autoPlugMoreVideos;break;default:n=r.autoPlugWatchMore}s.innerHTML=o.onDemandButton.render({buttonText:n,accessibilityLabel:n}),l=e.firstChild,t.add(l,u,d,c)},setPosition:function(e,t){s&&(s.style.top=e-8+"px",s.style.right=t+"px")}}}),define("countdownItem/countdownItem",["model/cpModel","model/copy","model/templates","utils/eventbus","utils/cssTools","utils/uiListener","utils/playlistTools","utils/generalUtils","model/config"],function(e,t,n,i,o,a,s,l,r){"use strict";var u,d,c,b,f,g,p,m,_,v,h,C,E,A,y,I,P,S,w,T,L=!1,O=!1,D="",N=function(e,n){d=e,c=n,u=t.translations,R(),x(),window.addEventListener("keyup",U.bind(this))},M=function(e){d&&("useBottom"!==e?d.style.top=e+"px":(d.style.top="",d.style.bottom=0))},R=function(){b=document.createElement("div"),b.className="gcp_inpageCountdownHeader",g=document.createElement("div"),g.className="gcp_inpageCountdownItemContent backgroundFadedOut",d.insertBefore(b,d.childNodes[0]),d.insertBefore(g,d.childNodes[0]),E=document.createElement("div"),E.className="gcp_spinnerCountdown",E.id="gcp_spinnerCountdown",d.insertBefore(E,d.childNodes[0])},x=function(){a.add(g,W)},U=function(e){var t=e.keyCode?e.keyCode:e.which;e.ctrlKey&&81==t&&J()},F=function(){p&&(p.style.backgroundColor=e.viewModel.highlightColour)},B=function(){p&&(p.style.backgroundColor="transparent")},k=function(){var e=parseInt((Date.now()-w)/1e3);return i.dispatch(i.DISMISS_CP,e),q(),i.dispatch(i.DISMISS_CLICK_FROM_NEXT_ITEM_PANEL),y.setAttribute("tabIndex","-1"),y.setAttribute("aria-hidden","true"),!1},W=function(e){var t=parseInt((Date.now()-w)/1e3);return i.dispatch(i.COUNTDOWN_CLICK,t),q(),e.stopPropagation(),!1},Y=function(){i.dispatch(i.COUNTDOWN_SKIPPED),J()},H=function(){f&&(L=!0,f.style.color=e.viewModel.highlightColour)},G=function(){f&&(L=!1,f.style.color="#ffffff")},K=function(){f&&(L=!0,f.style.color=e.viewModel.highlightColour,o.addRemoveCSSclassToElement(C,"gcp_spinnerCountdown_button_focused"))},V=function(){f&&(L=!1,f.style.color="#ffffff",o.addRemoveCSSclassToElement(C,"","gcp_spinnerCountdown_button_focused"))},X=function(){y&&(m.style.fill=e.viewModel.highlightColour)},j=function(){y&&(m.style.fill="#FFFFFF")},J=function(){v.innerHTML=u.autoPlugUpNextStopped,o.addRemoveCSSclassToElement(c,"gcp_countdownStopped"),setTimeout(function(){o.addRemoveCSSclassToElement(c,"leftTransitionRemoved")},700),clearInterval(I),clearInterval(T),setTimeout(function(){te(),i.dispatch(i.CAROUSEL_REQUIRES_UPDATED_ARIA)},600);var e=h.getAttribute("aria-label"),t=u.autoPlugAccessibilityCountdownStopped+". "+e;h.setAttribute("aria-label",t),h.focus()},q=function(){clearInterval(I),clearInterval(T),Q(),e.viewModel.countdownRunning=!1,O=!1,te(!0),o.addRemoveCSSclassToElement(c,"gcp_nextItemPanelClosed"),o.addRemoveCSSclassToElement(c,"","gcp_countdownStopped"),o.addRemoveCSSclassToElement(c,"","nextItemPanelInitialised")},z=function(){if(!O){o.addRemoveCSSclassToElement(c,"","gcp_nextItemPanelClosed"),o.addRemoveCSSclassToElement(c,"","leftTransitionRemoved"),O=!0,S=P,e.viewModel.countdownRunning=!0;var t=u.autoPlugUpNext;$(S,t,u.autoPlugCloseCountdownAccessibilityText),v=b.getElementsByClassName("gcp_countdownText")[0],_=E.getElementsByClassName("gcp_timer")[0],m=b.getElementsByClassName("gcp_closeSVG")[0],h=g.getElementsByClassName("gcp_item")[0],a.add(h,null,F,B),p=g.getElementsByClassName("gcp_itemCtaIcon")[0],a.add(p,null,F,B);var n=e.getNextPlayingItem(),s=n.playlist;if(s)var l=s.title+" ";""!=D&&D!=u.autoPlugLive?(l=l+" "+u.autoPlugDurationTime,l=l.replace("{time}",D)):D==u.autoPlugLive&&(l=l+" "+u.autoPlugLive);var r=e.getItems();l=u.autoPlugPlayItemNumber+" "+l,l=l.replace("{number}",1),l=l.replace("{total}",r.length);var d=g.childNodes[0];d.setAttribute("aria-label",l),d.setAttribute("title",l),I=window.setInterval(function(){if(!L){S--;var e="0"==S?"":S;if(_.innerHTML=e,S<=0)return q(),void i.dispatch(i.COUNTDOWN_COMPLETE)}},1e3);o.hasClass(c,"gcp_countdownStopped")&&o.addRemoveCSSclassToElement(c,"","gcp_countdownStopped"),i.dispatch(i.COUNTDOWN_STARTED),Z(),A.focus(),A&&(a.add(A,null,K,V),A.style.outlineColor=e.viewModel.highlightColour)}},Q=function(){i.dispatch(i.SHOW_SMP_SCRUBBAR),h&&(h.setAttribute("tabIndex","-1"),h.setAttribute("aria-hidden","true"),r.IS_WIN7_IE11&&(h.style.display="none")),h&&h.blur(),A&&(A.setAttribute("tabIndex","-1"),A.setAttribute("aria-hidden","true"),f.setAttribute("tabIndex","-1"),f.setAttribute("aria-hidden","true")),o.fadeOut(d)},Z=function(){e.viewModel.isFullscreen||i.dispatch(i.HIDE_SMP_SCRUBBAR),h&&(r.IS_WIN7_IE11&&(h.style.display="block"),h.setAttribute("tabIndex","1002"),h.setAttribute("aria-hidden","false")),A&&(A.setAttribute("tabIndex","1000"),A.setAttribute("aria-hidden","false"),f.setAttribute("tabIndex","1001"),f.setAttribute("aria-hidden","false")),o.fadeIn(d),setTimeout(function(){o.addRemoveCSSclassToElement(c,"nextItemPanelInitialised")},400)},$=function(t,i,l){var d=u.autoPlugCloseCountdownAccessibilityText;b.innerHTML=n.countdownItem.render({countdownText:i,accessibilityLabel:d});var p=e.getNextPlayingItem(),m=s.mergeIntoPlaylist(p);D=s.setLiveOrDuration(p,m,u);var _=s.getVoiceReadersDuration(D,u),v=s.getFallbackImage(),h="";window.Utils&&m.holdingImageURL&&(v=window.Utils.doChef(m.holdingImageURL,null,null,200),h=window.Utils.getImgSources(m.holdingImageURL)),g.innerHTML=n.carouselItem.render({buttonOrDiv:"button",role:"",title:m.title,holdingImageURL:v,srcset:h,description:m.summary,date:m.date,duration:D,durationAriaLabel:_}),te();var I=2*Math.PI*48,P=I+"px, "+I+"px",O="stroke-dasharray:"+P+'; stroke-dashoffset:-0px; transition:stroke-dashoffset 0.1s linear;"',N=m.title,M=u.autoPlugAccessibilityLabelCountdownNew,R=M.replace("{title}",N),x=u.autoPlugCancel;E.innerHTML=n.countdownSpinner.render({default_pathString:"M 50,50 m 0,-48 a 48,48 0 1 1 0,96 a 48,48 0 1 1 0,-96",fullCircleStrokeDasharray:P,pathStyle:O,seconds:t,strokeColour:e.viewModel.highlightColour,accessibilityLabelCountdown:R,cancel:x}),w=Date.now();var U=10*S,F=1,B=document.getElementsByClassName("gcp_circle_animation")[0];T=setInterval(function(){if(!L){if(F==U)return void clearInterval(T);var e=(F+1)*(I/U);B&&(B.style.strokeDashoffset=e),F++}},100),f=document.getElementsByClassName("gcp_cancel")[0],C=document.getElementsByClassName("gcp_spinnerCountdownWrap")[0],A=document.getElementsByClassName("gcp_spinnerCountdown_button")[0];var W=document.getElementsByClassName("gcp_timerX")[0];f.style.outlineColor=e.viewModel.highlightColour,W&&(W.style.fill=e.viewModel.highlightColour),C&&a.add(C,Y,H,G),r.IS_OLD_IPAD&&(o.addRemoveCSSclassToElement(E,"oldIpad",""),7===r.IOS_VERSION&&o.addRemoveCSSclassToElement(E,"oldIpadIos7","")),y=c.getElementsByClassName("gcp_countdownClose")[0],y&&a.add(y,k,X,j),r.IS_IOS||r.IS_MAC_SAFARI||window.ScreenReader&&window.ScreenReader.alert(R)},ee=function(e){(e>20||e<5)&&(e=10),P=Math.round(e)},te=function(t){b.offsetWidth&&(e.viewModel.nextItemPanelWidth=t?0:b.offsetWidth,i.dispatch(i.NEXT_ITEM_PANEL_WIDTH))};return{init:N,setCountdownDurationSecs:ee,startCountdown:z,stopCountdown:q,onDismissClick:k,dismissCountdown:Y,setPosition:M}}),define("utils/cookiesHelper",["model/config"],function(e){"use strict";function t(){try{var e=RegExp("ckps_onwardJourney[^;]+").exec(document.cookie);return decodeURIComponent(e?e.toString().replace(/^[^=]+./,""):"")}catch(e){return""}}function n(){i();try{var n=document.cookie}catch(e){n=""}if(-1==n.indexOf("ckps_onwardJourney="))return null;var o=t("ckps_onwardJourney");try{o=JSON.parse(o)}catch(e){o={}}return""!=e.PRODUCT_NAME?!o.hasOwnProperty(e.PRODUCT_NAME)||o[e.PRODUCT_NAME].enabled:!o.hasOwnProperty("enabled")||o.enabled}function i(){try{var e=document.cookie}catch(t){e=""}var t=e.indexOf("ckps_onwardJourney=");if(-1==t)return null;t+=19;var n=t+1,i=e.substring(t,n);1==i?a(!0,!0):0==i&&a(!1,!0)}var o=function(){try{var e=document.cookie}catch(t){e=""}var t=e.indexOf("ckns_policy=")+12,n=t+3;if(-1==t)return!1;var i=e.substring(t,n);return!i||"0"!=i[1]},a=function(n,i){if(o()){var a=new Date;a.setTime(a.getTime()+15552e6),a.setDate(15),a.setHours(12),a.setMinutes(0),a.setSeconds(0);var s="; expires="+a.toGMTString(),l=location.hostname;-1!==l.indexOf(".bbc.co.uk")&&(l=".bbc.co.uk"),-1!==l.indexOf(".bbc.com")&&(l=".bbc.com");var r,u=t("ckps_onwardJourney");if(""==u||i)r={};else try{r=JSON.parse(u)}catch(e){r={}}var d;if(""!=e.PRODUCT_NAME){var c={};c.enabled=n,r[e.PRODUCT_NAME]=c,d=JSON.stringify(r)}else r.enabled=n,d=JSON.stringify(r);try{document.cookie="ckps_onwardJourney="+encodeURIComponent(d)+s+"; Domain="+l+"; Path=/"}catch(e){}}};return{setCookie:a,getCookie:n}}),define("controller",["utils/languageMappings","utils/eventbus","model/statsConstants","model/copy","model/templates","carousel/carousel","carousel/onDemandCarouselButton","countdownItem/countdownItem","utils/playlistTools","utils/cssTools","model/cpModel","model/config","utils/cookiesHelper"],function(e,t,n,i,o,a,s,l,r,u,d,c,b){"use strict";function f(e){switch(e.name){case"dfpAds.js":g()}}function g(){!1===c.AD_PLUGIN_EXISTS&&(c.AD_PLUGIN_EXISTS=!0,m.addEventListener("bbc.smp.plugins.ads.event.AdsPluginExternalEvent.ALL_ADS_COMPLETED",function(){ae()}),h=!1)}var p,m,_,v,h,C,E,A,y,I,P,S=!1,w=!1,T=!1,L=!1,O=!0,D=!1,N=!1,M=!0,R=function(t){p=t,m=p.playerInterface,C="onwardJourneyPlugin",d.viewModel.highlightColour=m.settings.ui.colour,d.viewModel.foreHighlightColour=m.settings.ui.foreColour,d.viewModel.controlsAlwaysOriginalSetting=!(!m.settings.ui.controls||!m.settings.ui.controls.always),m.settings.ui.accessibility&&(d.viewModel.enhanceBrightColoursContrast=m.settings.ui.accessibility.enhanceBrightColoursContrast),m.addContextMenuItem&&m.addContextMenuItem("_onwardJourneyPluginIdHTML","OnwardJourneyPluginHTML.2.6.6"),G(),K(),V();for(var n=t.getPluginList(),i=0;i<n.length;i++)if("dfpAds.js"===n[i].name){g();break}var o,a=m.settings.ui.locale.lang;o=e.map(a),_="../css/"+o+".css",p.loadCSS(_,C)},x=function(e){e.path==_&&e.id==C&&(F(),Y(),T=!0,H())},U=function(e){e.path==_&&e.id==C&&(v||(v=!0,_="../css/en.css",p.loadCSS(_,C)))},F=function(){var e=m.datastore.get(c.CONT_PLAY_DATA_KEY);if(e){var t={data:{name:c.CONT_PLAY_DATA_KEY,data:e}};$(t)}},B=function(){null==b.getCookie()?(c.CP_ENABLED=!0,m.settings={continuousPlay:!0}):0==b.getCookie()?(c.CP_ENABLED=!1,m.settings={continuousPlay:!1}):(c.CP_ENABLED=!0,m.settings={continuousPlay:!0}),m.dispatchEvent({type:"continuousPlayInitialised",status:c.CP_ENABLED})},k=function(){E&&A&&I&&y&&(E.setAttribute("aria-hidden","true"),E.setAttribute("tabIndex","-1"),A.setAttribute("aria-hidden","true"),A.setAttribute("tabIndex","-1"),I.setAttribute("aria-hidden","true"),I.setAttribute("tabIndex","-1"),y.setAttribute("aria-hidden","true"),y.setAttribute("tabIndex","-1"))},W=function(){E&&A&&I&&y&&(E.setAttribute("aria-hidden","false"),E.setAttribute("tabIndex",""),A.setAttribute("aria-hidden","false"),A.setAttribute("tabIndex",""),I.setAttribute("aria-hidden","false"),I.setAttribute("tabIndex",""),y.setAttribute("aria-hidden","false"),y.setAttribute("tabIndex",""))},Y=function(){var e=document.createElement("div");e.className="svgHolder",e.innerHTML=o.icons.render({}),m.container.appendChild(e),E=document.createElement("div"),E.className="gcp_inpageCountdownItem fadedOut",E.style.pointerEvents="none",m.container.appendChild(E),l.init(E,m.container),A=document.createElement("ul"),A.className="gcp_carouselContainer fadedOut",m.container.appendChild(A),I=document.createElement("div"),I.className="gcp_carouselBackground fadedOut";var t=document.createElement("p");t.className="gcp_moreContentTitle";var n=document.createElement("div");n.className="gcp_carouselBackgroundLeftGradient fadedOut";var i=document.createElement("p");i.className="gcp_upNextTitle ",n.appendChild(i),I.appendChild(t),I.appendChild(n),m.container.appendChild(I),y=document.createElement("div"),y.className="gcp_carouselControls fadedOut",m.container.appendChild(y),a.init({container:A,background:I,controls:y},m.container);var r=document.createElement("div");r.className="gcp_onDemandButtonContainer",m.container.appendChild(r),s.init(r),D=!0},H=function(){var e=m.playlist;if(e){ie({playlist:e})}},G=function(){var e=navigator.userAgent,t=/windows phone/i.test(e),n=/iPhone/i.test(e)&&!t,i=/iPod/i.test(e)&&!t,o=/iPad/i.test(e)&&!t,a=n||o||i,s=null,l=(/Android/i.test(e),/Safari/i.test(e)&&/Mac/i.test(e)&&!/Chrome/i.test(e)&&!t),r=/trident\/7/i.test(e),u=/windows NT 6\.1/i.test(e),d=r&&u,b=/windows/i.test(e);if(a){var f=e.match(/OS ([0-9]+)/);s=f?parseInt(f[1],10):0}c.IS_IPHONE_OR_IPOD=n||i,c.IS_IPHONE=n,c.HAS_FOCUS_BUG=a,c.IS_IOS=a,c.IS_MAC_SAFARI=l,c.IOS_VERSION=s,c.IS_OLD_IPAD=s>0&&s<9&&o,c.IS_WINDOWS=b,c.IS_WIN7_IE11=d},K=function(){t.addEventListener(t.CAROUSEL_ITEM_CLICK,me),t.addEventListener(t.COUNTDOWN_COMPLETE,_e),t.addEventListener(t.DISMISS_CP,ge),t.addEventListener(t.COUNTDOWN_CLICK,pe),t.addEventListener(t.SHOW_SMP_SCRUBBAR,Ce),t.addEventListener(t.HIDE_SMP_SCRUBBAR,Ee),t.addEventListener(t.COUNTDOWN_SKIPPED,ve),t.addEventListener(t.CAROUSEL_DRAGGED,Ae),t.addEventListener(t.NEXT_ITEM_PANEL_WIDTH,ye),t.addEventListener(t.COUNTDOWN_STARTED,Ie),t.addEventListener(t.CLOSE_BUTTON_CLICKED,Pe),t.addEventListener(t.CAROUSEL_REQUIRES_UPDATED_ARIA,Se),t.addEventListener(t.ON_DEMAND_CAROUSEL_BUTTON_CLICK,we),t.addEventListener(t.DISMISS_CLICK_FROM_NEXT_ITEM_PANEL,Te)},V=function(){P={ended:z},m.listenerObject={setData:$,uiinfo:re,ended:X,playlistLoaded:ie,playlistLoading:te,playing:Q,adsPlugin:Z,cssLoaded:x,cssLoadFailed:U,mediaItemChanged:q,continuousPlayChange:de,continuousPlayToggleSwitched:ce,controlsPanelOpened:be,chromecastToggle:fe,pluginLoaded:f}},X=function(e){P[e.type]&&M&&P[e.type](e)},j=function(){M=!0},J=function(){M=!1},q=function(e){e&&(e.isLive,c.CP_ENABLED)},z=function(e){c.AD_PLUGIN_EXISTS&&!1===h?S=!0:(m.queuePlaylist({}),le())},Q=function(){k(),ue(),w&&(w=!1,m.dispatchEvent({type:n.CP_PLAY,origin:n.CP_PLAY_VIDEO_REPLAY}),m.trackAction(n.AP_PLAY_VIDEO_REPLAY)),d.viewModel.countdownRunning&&(l.stopCountdown(),m.dispatchEvent({type:n.CP_PLAY,origin:n.CP_PLAY_VIDEO_REPLAY}),m.trackAction(n.AP_PLAY_VIDEO_REPLAY)),L=m.isFromIdent,d.viewModel.onDemandCarouselShown=!1,m.updateUiConfig({controls:{always:d.viewModel.controlsAlwaysOriginalSetting}},!0),a.hide()},Z=function(e){"adStarted"===e.id&&(d.viewModel.showingAds=!0),"adEnded"===e.id&&(d.viewModel.showingAds=!1)},$=function(e){if(e.data.name==c.CONT_PLAY_DATA_KEY){var t=e.data.data;if(void 0!==t.disableUX&&(!0===t.disableUX?J():!1===t.disableUX&&j()),t.disableWhenEmbedded&&t.disableWhenEmbedded.enabled?(c.DISABLE_WHEN_EMBEDDED=!0,t.disableWhenEmbedded.breakpoint&&(c.DISABLE_WHEN_EMBEDDED_BREAKPOINT="number"==typeof t.disableWhenEmbedded.breakpoint?t.disableWhenEmbedded.breakpoint:1e4)):c.DISABLE_WHEN_EMBEDDED=!1,t.continuousPlayName){var n=t.continuousPlayName.match(/([a-z0-9_])+/g);n&&(c.PRODUCT_NAME=n.join(""))}t.fullscreenOnlyCarousel?(c.FULLSCREEN_ONLY_CAROUSEL=t.fullscreenOnlyCarousel,u.addRemoveCSSclassToElement(m.container,"gcp_fullscreenOnlyCarousel","gcp_carouselOnDemandAlways")):t.alwaysShowCarouselButton&&u.addRemoveCSSclassToElement(m.container,"gcp_carouselOnDemandAlways","gcp_fullscreenOnlyCarousel"),t.openCarouselButtonLabel&&"number"==typeof t.openCarouselButtonLabel&&t.openCarouselButtonLabel<=6&&t.openCarouselButtonLabel>0&&(c.OPEN_CAROUSEL_BUTTON_LABEL=t.openCarouselButtonLabel),!1===t.showDate?u.addRemoveCSSclassToElement(m.container,"gcp_noDate",""):u.addRemoveCSSclassToElement(m.container,"","gcp_noDate");var o=c.IS_WINDOWS?1e3:0;if(setTimeout(function(){B()},o),t.items){var s=r.validateTheData(t,m.container);d.setItems(s)}setTimeout(function(){m.updateUiConfig({controls:{availableOnMediaEnded:!0},chromecast:{shiftCentralControls:!0}})},o),l.setCountdownDurationSecs(t.countdownDurationSecs||c.DEFAULT_COUNTDOWN_SECS),i.update(),"true"!==t.pretendPlaylistHasAds&&!0!==t.pretendPlaylistHasAds||(c.PRETEND_PLAYLIST_HAS_ADS=!0),!0!==t.stopAutoplayOnGuidance&&!1!==t.stopAutoplayOnGuidance||(c.STOP_ON_GUIDANCE=t.stopAutoplayOnGuidance),!0===T&&a.createCarousel(!0),ee(),t.autoPlayFirstItem&&!N&&(N=!0,m.play(!0))}},ee=function(){var e=d.getItems(),t=d.getLoadedPlaylistURLorPID();if(e&&e.length>0&&""!==t){var n=r.checkForLoadedPlaylistURLorPIDinData(t,e);-1!=n?(d.setCurrentlyPlayingIndex(n),a.positionAtIndex(n)):d.setCurrentlyPlayingIndex(-1)}},te=function(e){ne(),d.resetForNewPlaylist(),h=!1,a.hide()},ne=function(){d.viewModel.countdownRunning&&l.stopCountdown(),w=!1,S=!1},ie=function(e){if(d.getURLorPID(e.playlist)!==d.getLoadedPlaylistURLorPID()&&T){d.viewModel.playlistLoading=!1;var t=e.playlist;d.setLoadedPlaylist(t),ee(),oe(t)}},oe=function(e){!1!==e.hasAds||c.PRETEND_PLAYLIST_HAS_ADS||ae()},ae=function(){h=!0,d.viewModel.showingAds=!1,!0===S&&(S=!1,le())},se=function(){var e=!d.viewModel.isFullscreen&&c.DISABLE_WHEN_EMBEDDED&&d.viewModel.videoWidth<c.DISABLE_WHEN_EMBEDDED_BREAKPOINT;return e?u.addRemoveCSSclassToElement(m.container,"gcp_disableWhenEmbedded",""):u.addRemoveCSSclassToElement(m.container,"","gcp_disableWhenEmbedded"),e},le=function(){if(!(d.viewModel.tooSmallForContinuousPlay||L||d.viewModel.onDemandCarouselShown||se()))if(W(),c.CP_ENABLED){var e=c.IS_OLD_IPAD?700:0;setTimeout(function(){d.hasMoreItemsToPlay()&&(m.dispatchEvent({type:"continuousPlayCountdownStarted"}),l.startCountdown(),setTimeout(function(){var e=d.getNextPlayingItem(),t={};t.options={},e.counterName&&(t.options.counterName=e.counterName),e.statsObject&&(t.options.statsObject=e.statsObject),t.options.autoplay=!1!==e.autoplay,t.options.fromOnwardJourney=!0,t.playlist=e.playlist,m.queuePlaylist(t)},500)),a.show(!d.hasMoreItemsToPlay()),O=!0},e)}else a.show(!0)},re=function(e){e.videoWidth!=d.viewModel.videoWidth&&(d.viewModel.videoWidth=e.videoWidth,d.viewModel.tooSmallForContinuousPlay=e.videoWidth<320,a.updateScrollButtons()),e.isFullscreen!=d.viewModel.isFullscreen&&(d.viewModel.isFullscreen=e.isFullscreen),e.isFullscreen?u.addRemoveCSSclassToElement(m.container,"gcp_fullscreen",""):u.addRemoveCSSclassToElement(m.container,"","gcp_fullscreen"),d.viewModel.tooSmallForContinuousPlay&&d.viewModel.countdownRunning&&(l.stopCountdown(),a.hide());var t=0;if(t=e.isFullscreen?window.innerWidth:e.videoWidth,D){var n=e.controlsTop-88,i=e.seekBarLeft;s.setPosition(n,i);var o=t>=750?e.controlsTop-226-44:"useBottom";l.setPosition(o),a.setPosition(o)}ue(),se()},ue=function(){d.viewModel.tooSmallForContinuousPlay?m.updateUiConfig({playbackSettingsPanel:{enabled:!1,continuousPlaySetting:!1}}):m.updateUiConfig({playbackSettingsPanel:{enabled:!0,continuousPlaySetting:!0}})},de=function(e){c.CP_ENABLED!=e.status&&(c.CP_ENABLED=e.status,b.setCookie(e.status))},ce=function(e){m.dispatchEvent({type:n.CP_STATS,id:e.status?n.CP_STATS_TURN_CP_ON:n.CP_STATS_TURN_CP_OFF}),m.trackAction(e.status?n.AP_STATS_TURN_AP_ON:n.AP_STATS_TURN_AP_OFF)},be=function(){d.viewModel.countdownRunning&&l.dismissCountdown()},fe=function(){d.viewModel.countdownRunning&&l.dismissCountdown()},ge=function(e){m.dispatchEvent({type:n.CP_STATS,id:n.CP_STATS_DISMISS_CONT_PLAY,secondsIntoCountdown:e}),m.trackAction(n.AP_STATS_DISMISS_CONT_PLAY),w=!0,m.queuePlaylist({}),m.focusPlayPauseButton(),k()},pe=function(e){m.dispatchEvent({type:n.CP_PLAY,origin:n.CP_PLAY_VIDEO_COUNTDOWN_CLICKED,fullscreen:d.viewModel.isFullscreen,index:d.getCurrentlyPlayingItemIndex()+1,secondsIntoCountdown:e}),m.trackAction(n.AP_PLAY_VIDEO_COUNTDOWN_CLICKED,null,{secondsIntoCountdown:e}),c.STOP_ON_GUIDANCE&&m.playlist.queuedPlaylist.guidance?(m.stop(),m.next(!1)):m.next(!0),m.focusPlayPauseButton(),k()},me=function(e){m.dispatchEvent({type:n.CP_PLAY,origin:n.CP_PLAY_VIDEO_CAROUSEL_CLICKED,fullscreen:d.viewModel.isFullscreen,index:a.getClickedOnCarouselItemIndex()}),m.trackAction(n.AP_PLAY_VIDEO_CAROUSEL_CLICKED),he(e),m.focusPlayPauseButton(),k()},_e=function(){m.dispatchEvent({type:n.CP_PLAY,origin:n.CP_PLAY_VIDEO_COUNTDOWN_COMPLETE,fullscreen:d.viewModel.isFullscreen,index:d.getCurrentlyPlayingItemIndex()+1}),m.trackAction(n.AP_PLAY_VIDEO_COUNTDOWN_COMPLETE),c.STOP_ON_GUIDANCE&&m.playlist.queuedPlaylist.guidance||m.playlist.queuedOptions&&!1===m.playlist.queuedOptions.autoplay?(m.stop(),m.next(!1)):m.next(!0),m.focusPlayPauseButton(),k()},ve=function(){m.trackAction(n.AP_STATS_COUNTDOWN_SKIPPED)},he=function(e){if(e){var t={};t.autoplay=!0,c.STOP_ON_GUIDANCE&&e.playlist.guidance&&(t.autoplay=!1),e.counterName&&(t.counterName=e.counterName),e.statsObject&&(t.statsObject=e.statsObject),m.loadPlaylist(e.playlist,t)}},Ce=function(){m.updateUiConfig({controls:{mode:"default"}})},Ee=function(){d.viewModel.countdownRunning||m.updateUiConfig({controls:{mode:"controls"}})},Ae=function(){O&&(O=!1,l.stopCountdown(),a.updateCarouselItemsList())},ye=function(){a.updateScrollButtons()},Ie=function(){a.reSetCarouselLeft()},Pe=function(){d.viewModel.onDemandCarouselShown=!1,m.updateUiConfig({controls:{always:d.viewModel.controlsAlwaysOriginalSetting}}),l.onDismissClick(),a.hide(),window.ScreenReader&&window.ScreenReader.alert(null,!0)},Se=function(){a.updateAriaAndTabIndex()},we=function(e){d.viewModel.onDemandCarouselShown=!0,m.updateUiConfig({controls:{always:!0}}),d.viewModel.previousActiveElement=document.activeElement,a.show(!0,e),W(),m.trackAction(n.AP_ON_DEMAND_CAROUSEL_BUTTON_CLICK,null,{fullscreen:d.viewModel.isFullscreen})},Te=function(){a.hide(),m.trackAction(n.AP_DISMISS_CLICK_FROM_NEXT_ITEM_PANEL)};return{init:R}});var runPlugin=function(e,t){return e.register({name:"onwardJourney.js"}),{pluginInitialisation:function(e){require(["controller"],function(t){t.init(e)})}}};define("plugin",function(){});